(this["webpackJsonpaudio-recording"]=this["webpackJsonpaudio-recording"]||[]).push([[0],{155:function(e,t,n){e.exports=n(225)},169:function(e,t){},171:function(e,t){},204:function(e,t,n){},225:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(9),i=n.n(r),c=n(15),l=n(12),s=n(18),u=n(19),d=n(20),p=n(35),h=n(29),m=n(41),f=n(31),E=n(62),b=function(e){var t=Math.floor(e/3600),n=Math.floor(e%3600/60),a=Math.floor(e)%60;return[t,n>9?n:t?"0"+n:n||"0",a>9?a:"0"+a].filter((function(e){return e})).join(":")},O=function(e){var t=Number.parseFloat(e/1024/1024).toFixed(2);return"0.00"===t?e+" Bytes":t+" MB"},v={recording:!1,records:[],permissionDenied:!1,maxRecorded:0},g={alertDeletion:!1,zip:"NONE"},y=Object(p.c)({audio:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CHANGE_RECORD_STATE":return Object(m.a)({},e,{recording:!e.recording});case"RECORDING_DENIED":return Object(m.a)({},e,{permissionDenied:!0});case"FINISH_RECORDING":var n=new Date;return Object(m.a)({},e,{records:[].concat(Object(h.a)(e.records),[{title:"Untitled #"+(e.maxRecorded+1),duration:"",size:O(t.payload.blob.size),dateTime:n.toDateString()+", "+n.toLocaleTimeString(),url:URL.createObjectURL(t.payload.blob),blob:t.payload.blob}]),maxRecorded:e.maxRecorded+1});case"CHANGE_TITLE":return Object(f.a)(e,(function(e){e.records[t.payload.index].title=t.payload.title}));case"DURATION_DETERMINED":return Object(f.a)(e,(function(e){e.records[t.payload.index].duration=b(t.payload.duration)}));case"DELETE_ALL":return Object(f.a)(e,(function(e){e.records=[]}));case"DOWNLOAD_SINGLE_RECORDING":return Object(E.saveAs)(t.payload.record.blob,t.payload.record.title+".mp3"),e;case"DELETE_SINGLE_RECORDING":return Object(f.a)(e,(function(e){e.records.splice(t.payload.index,1)}));default:return e}},app:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ALERT_DELETION":return Object(f.a)(e,(function(e){e.alertDeletion=t.payload.alertDeletion}));case"DELETE_ALL":return Object(f.a)(e,(function(e){e.alertDeletion=!1}));case"DOWNLOAD_ALL_PENDING":return Object(f.a)(e,(function(e){e.zip="ZIPPING"}));case"DOWNLOAD_ALL_FULFILLED":return Object(E.saveAs)(t.payload,"audios.zip"),Object(f.a)(e,(function(e){e.zip="NONE"}));default:return e}}}),D=n(24),j=n(128),C=n(138),R=n(265),k=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||p.d,w=Object(p.e)(y,{audio:v,app:g},k(Object(p.a)(j.a))),N=Object(C.a)({palette:{type:"dark",primary:{main:"#90caf9"}}}),I=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement(R.a,{theme:N},o.a.createElement("div",{id:"container"},o.a.createElement(D.a,{store:w},this.props.children)))}}]),t}(o.a.Component),x=n(273),L=n(284),T=n(269),A=n(4),B=n(272),_=n(129),S=n.n(_),M=n(130),z=n.n(M),G=n(141),P=n(266),U=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).audio=o.a.createRef(),n.state={show:!0},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentWillUnmount",value:function(){this.setState({show:!1})}},{key:"render",value:function(){var e=this,t=this.props.classes,n=this.props;return o.a.createElement(P.a,{direction:"right",in:this.state.show,unmountOnExit:!0},o.a.createElement(G.a,{elevation:4},o.a.createElement("div",{className:"recordItem"},o.a.createElement(T.a,{container:!0,spacing:3},o.a.createElement(T.a,{item:!0,xs:2},o.a.createElement("div",{className:"title"},o.a.createElement(L.a,{InputProps:{className:t.input},onChange:function(e){return n.onChangeTitle(e.target.value)},value:n.title})),o.a.createElement("div",{className:"dateTime"},n.dateTime)),o.a.createElement(T.a,{item:!0,xs:6},o.a.createElement("div",{className:"audioPlayerContainer"},o.a.createElement("audio",{ref:this.audio,src:n.url,controls:"controls",onLoadedMetadata:function(){n.durationDetermined(e.audio.current.duration)}}))),o.a.createElement(T.a,{item:!0,xs:1},o.a.createElement("div",{className:"metadataContainer"},o.a.createElement("div",{className:"duration"},n.duration),o.a.createElement("div",{className:"size"},n.size))),o.a.createElement(T.a,{item:!0,xs:3},o.a.createElement("div",{id:"downloadButtonContainer"},o.a.createElement(B.a,{size:"medium",classes:t.root,onClick:this.props.onDownloadButtonClicked},o.a.createElement(S.a,null)),o.a.createElement(B.a,{"aria-label":"delete",classes:t.root,onClick:this.props.onDeleteButtonClicked},o.a.createElement(z.a,null))))))))}}]),t}(o.a.Component),F=Object(A.a)({input:{color:"#0096ef",fontSize:"18px"}})(U),W=n(142),H=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return 0!==this.props.records.length?o.a.createElement("div",null,o.a.createElement("ul",null,this.props.records.map((function(t,n){return o.a.createElement("div",{key:n},o.a.createElement("li",{key:n},o.a.createElement(F,{key:n,title:t.title,dateTime:t.dateTime,duration:t.duration,size:t.size,url:t.url,onChangeTitle:function(t){return e.props.onChangeTitle(t,n)},durationDetermined:function(t){return e.props.duration(t,n)},onDownloadButtonClicked:function(){return e.props.onDownloadButtonClicked(e.props.records[n])},onDeleteButtonClicked:function(){return e.props.onDeleteButtonClicked(n)}})),o.a.createElement(x.a,null))}))),o.a.createElement("div",{id:"placeHolderItem"})):o.a.createElement("div",{id:"recordListInfoText"},o.a.createElement(W.a,{variant:"h4"},"You don't have any recordings yet. Press and hold the audio button on the bottom to start."))}}]),t}(o.a.Component),J=n(131),X=new(n.n(J).a),Z=function(e){return{type:"ALERT_DELETION",payload:{alertDeletion:e}}},V=Object(D.b)((function(e){return{records:e.audio.records}}),(function(e){return{onChangeTitle:function(t,n){return e(function(e,t){return{type:"CHANGE_TITLE",payload:{title:e,index:t}}}(t,n))},duration:function(t,n){return e(function(e,t){return{type:"DURATION_DETERMINED",payload:{duration:e,index:t}}}(t,n))},onDownloadButtonClicked:function(t){return e(function(e){return{type:"DOWNLOAD_SINGLE_RECORDING",payload:{record:e}}}(t))},onDeleteButtonClicked:function(t){return e(function(e){return{type:"DELETE_SINGLE_RECORDING",payload:{index:e}}}(t))}}}))(H),Y=n(226),q=n(274),K=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.classes;return o.a.createElement("div",{id:"mainContent"},o.a.createElement(V,null),o.a.createElement(Y.a,{className:e.backdrop,open:this.props.zipping},o.a.createElement(q.a,{color:"inherit"})))}}]),t}(o.a.Component),Q=Object(A.a)((function(e){return{backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}}}))(K),$=Object(D.b)((function(e){return{blobs:e.audio.blobs,zipping:"ZIPPING"===e.app.zip}}))(Q),ee=(n(204),n(283)),te=n(281),ne=n(282),ae=n(133),oe=n.n(ae),re=n(285),ie=n(134),ce=n.n(ie),le=n(135),se=n.n(le),ue=n(280),de=n(275),pe=n(279),he=n(277),me=n(278),fe=n(276),Ee=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement(de.a,{open:this.props.open,onClose:this.props.onClose,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},o.a.createElement(fe.a,{id:"alert-dialog-title"},"Delete all your recordings?"),o.a.createElement(he.a,null,o.a.createElement(me.a,{id:"alert-dialog-description"},"Are you sure you want to delete all your recordings?")),o.a.createElement(pe.a,null,o.a.createElement(ue.a,{onClick:this.props.onClose,color:"primary"},"Cancel"),o.a.createElement(ue.a,{onClick:this.props.deleteAll,color:"primary",autoFocus:!0},"Delete all"))))}}]),t}(o.a.Component),be=Object(D.b)((function(e){return{open:e.app.alertDeletion}}),(function(e){return{onClose:function(){return e(Z(!1))},deleteAll:function(){return e({type:"DELETE_ALL"})}}}))(Ee),Oe=n(139),ve=n(286),ge=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).setAnchorEl=function(e){n.setState({anchorEl:e.currentTarget})},n.close=function(){n.setState({anchorEl:null})},n.aboutClicked=function(){n.setState((function(e){return Object(m.a)({},e,{aboutOpen:!e.aboutOpen})}))},n.state={anchorEl:null,download:!1},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props.classes;return o.a.createElement("div",{className:t.root},o.a.createElement(te.a,{position:"static",className:t.root},o.a.createElement(ne.a,null,o.a.createElement(W.a,{variant:"h6",className:t.title},0!==this.props.records.length?this.props.records.length+" recodings":"Recordios"),this.props.hasRecords&&o.a.createElement("div",null,o.a.createElement(re.a,{title:"Download all as .zip"},o.a.createElement(B.a,{size:"medium",onClick:function(){e.setState((function(e){return Object(m.a)({},e,{download:!0})})),e.props.onDownloadButtonClicked(e.props.records)}},o.a.createElement(oe.a,null))),o.a.createElement(re.a,{title:"Delete all"},o.a.createElement(B.a,{size:"medium",onClick:this.props.onDeleteButtonClicked},o.a.createElement(ce.a,null)))),o.a.createElement(B.a,{"aria-label":"display more actions",edge:"end",onClick:this.setAnchorEl},o.a.createElement(se.a,null)),o.a.createElement(Oe.a,{id:"simple-menu",anchorEl:this.state.anchorEl,keepMounted:!0,open:Boolean(this.state.anchorEl),onClose:this.close},o.a.createElement(ve.a,{onClick:this.aboutClicked},"About")),o.a.createElement(de.a,{onClose:this.aboutClicked,"aria-labelledby":"customized-dialog-title",open:this.state.aboutOpen},o.a.createElement(fe.a,{id:"customized-dialog-title",onClose:this.aboutClicked},"Recordios v1.0"),o.a.createElement(he.a,{dividers:!0},o.a.createElement(W.a,{gutterBottom:!0},"Recordios is made possible by @renchen. If you have any suggestions or want to contribute, please PM me @renchen."))))),o.a.createElement(be,null))}}]),t}(o.a.Component),ye=Object(A.a)((function(e){return{root:{flexGrow:1,backgroundColor:"#424242"},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1,color:"white"},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}}}))(ge),De=Object(D.b)((function(e){return{hasRecords:0!==e.audio.records.length,records:e.audio.records}}),(function(e){return{onDownloadButtonClicked:function(t){return e(function(e){return e.forEach((function(e){return X.file(e.title+".mp3",e.blob)})),{type:"DOWNLOAD_ALL",payload:X.generateAsync({type:"blob"})}}(t))},onDeleteButtonClicked:function(){return e(Z(!0))}}}))(ye),je=n(50),Ce=n(136),Re=function(){function e(t){Object(c.a)(this,e),this.config={sampleRate:44100,bitRate:128},Object.assign(this.config,t),this.mp3Encoder=new Ce.Mp3Encoder(1,this.config.sampleRate,this.config.bitRate),this.maxSamples=1152,this.samplesMono=null,this.clearBuffer()}return Object(l.a)(e,[{key:"clearBuffer",value:function(){this.dataBuffer=[]}},{key:"appendToBuffer",value:function(e){this.dataBuffer.push(new Int8Array(e))}},{key:"floatTo16BitPCM",value:function(e,t){for(var n=0;n<e.length;n++){var a=Math.max(-1,Math.min(1,e[n]));t[n]=a<0?32768*a:32767*a}}},{key:"convertBuffer",value:function(e){var t=new Float32Array(e),n=new Int16Array(e.length);return this.floatTo16BitPCM(t,n),n}},{key:"encode",value:function(e){this.samplesMono=this.convertBuffer(e);for(var t=this.samplesMono.length,n=0;t>=0;n+=this.maxSamples){var a=this.samplesMono.subarray(n,n+this.maxSamples),o=this.mp3Encoder.encodeBuffer(a);this.appendToBuffer(o),t-=this.maxSamples}}},{key:"finish",value:function(){return this.appendToBuffer(this.mp3Encoder.flush()),this.dataBuffer}}]),e}(),ke=function(){function e(t){Object(c.a)(this,e),this.config={bitRate:128,startRecordingAt:1,deviceId:null},this.activeStream=null,this.context=null,this.microphone=null,this.processor=null,this.startTime=0,Object.assign(this.config,t)}return Object(l.a)(e,[{key:"addMicrophoneListener",value:function(e){var t=this;this.activeStream=e,this.timerToStart=setTimeout((function(){delete t.timerToStart}),this.config.startRecordingAt),this.microphone=this.context.createMediaStreamSource(e),this.processor=this.context.createScriptProcessor(0,1,1),this.processor.onaudioprocess=function(e){t.timerToStart||t.lameEncoder.encode(e.inputBuffer.getChannelData(0))},this.microphone.connect(this.processor),this.processor.connect(this.context.destination)}},{key:"stop",value:function(){return this.processor&&this.microphone&&(this.microphone.disconnect(),this.processor.disconnect(),this.context&&"closed"!==this.context.state&&this.context.close(),this.processor.onaudioprocess=null,this.activeStream.getAudioTracks().forEach((function(e){return e.stop()}))),this}},{key:"start",value:function(){var e=this,t=window.AudioContext||window.webkitAudioContext||window.mozAudioContext;this.context=new t,this.config.sampleRate=this.context.sampleRate,this.lameEncoder=new Re(this.config);var n=!this.config.deviceId||{deviceId:{exact:this.config.deviceId}};return new Promise((function(t,a){navigator.mediaDevices.getUserMedia({audio:n}).then((function(n){e.addMicrophoneListener(n),t(n)})).catch((function(e){a(e)}))}))}},{key:"getMp3",value:function(){var e=this,t=this.lameEncoder.finish();return new Promise((function(n,a){0===t.length?a(new Error("No buffer to send")):(n([t,new Blob(t,{type:"audio/mp3"})]),e.lameEncoder.clearBuffer())}))}}]),e}(),we=n(137),Ne=n.n(we),Ie=n(227),xe=new ke({bitRate:128}),Le=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).start=function(){xe.start().then((function(){})).catch((function(e){return console.error(e)}))},n.stop=function(){xe.stop().getMp3().then((function(e){var t=Object(je.a)(e,2),a=(t[0],t[1]);n.props.finishRecording(a)})).catch((function(e){return console.log(e)}))},n.onRecordMouseDown=function(){n.props.recording||n.start(),n.props.changeRecordState()},n.onRecordMouseUp=function(){n.stop(),n.props.changeRecordState()},window.URL=window.URL||window.webkitURL,n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;navigator.mediaDevices.getUserMedia({audio:!0},(function(){console.log("Permission Granted")}),(function(){console.log("Permission Denied"),e.props.recordingDenied()}))}},{key:"render",value:function(){var e=this.props.classes;return o.a.createElement("div",null,o.a.createElement(B.a,{classes:{root:e.root},onMouseDown:this.onRecordMouseDown,onMouseUp:this.onRecordMouseUp,"aria-label":"Record",size:"medium"},o.a.createElement(Ne.a,null)))}}]),t}(o.a.Component),Te=Object(Ie.a)((function(e){return{root:{color:"white",backgroundColor:"rgb(245, 0, 87)",width:"56px",height:"56px",padding:"0",minWidth:0,borderRadius:"50%"}}}))(Le),Ae=Object(D.b)((function(e){return{recording:e.audio.recording,disableButton:e.audio.recording||e.audio.permissionDenied}}),(function(e){return{changeRecordState:function(){return e({type:"CHANGE_RECORD_STATE"})},recordingDenied:function(){return e({type:"RECORDING_DENIED"})},finishRecording:function(t){return e(function(e){return{type:"FINISH_RECORDING",payload:{blob:e}}}(t))}}}))(Te);i.a.render(o.a.createElement(I,null,o.a.createElement(De,null),o.a.createElement(ee.a,{maxWidth:!1,disableGutters:!0},o.a.createElement($,null)),o.a.createElement((function(){return o.a.createElement("div",{id:"bottomBar"},o.a.createElement("div",{id:"recordButton"},o.a.createElement(Ae,null)))}),null)),document.getElementById("root"))}},[[155,1,2]]]);
//# sourceMappingURL=main.2f8da285.chunk.js.map